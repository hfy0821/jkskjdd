(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-0eed9fca"],{"5bc8":function(t,e,a){"use strict";a.r(e);var i=function(){var t=this,e=t._self._c;return e("div",{staticClass:"confirm_warp multiSelectClass"},[e("h4",[t._v(t._s(t.title))]),"1"===t.i||"2"===t.i||"9"===t.i?e("div",{staticClass:"opinion"},[e("textarea",{directives:[{name:"model",rawName:"v-model.trim",value:t.remark,expression:"remark",modifiers:{trim:!0}}],attrs:{name:"",id:"",placeholder:"请输入意见"},domProps:{value:t.remark},on:{input:function(e){e.target.composing||(t.remark=e.target.value.trim())},blur:function(e){return t.$forceUpdate()}}}),e("div",{staticClass:"accessory"},[e("span",[t._v("附件")]),e("b",[e("i",{staticClass:"iconfont icon-fujian"},[e("input",{attrs:{multiple:"",type:"file",name:"",id:""},on:{change:t.fileChange}})])])]),e("ul",{staticClass:"file"},t._l(t.files,(function(a,i){return e("li",{key:i},[e("span",[t._v(t._s(a.fileName))]),e("i",{staticClass:"iconfont icon-cha2",on:{click:function(e){return t.delFile(i)}}})])})),0)]):t._e(),"6"===t.i?e("div",{staticClass:"designate"},[e("div",{staticClass:"item"},[e("p",[t._v("截止时间")]),e("input",{attrs:{type:"text",readonly:"",placeholder:"点击选择截止时间"},domProps:{value:t.formData.cutOffTime},on:{click:t.selectTime}})]),e("div",{staticClass:"item"},[e("p",[t._v("指派部门")]),e("input",{attrs:{type:"text",readonly:"",placeholder:"点击选择部门"},domProps:{value:t.formData.deptName},on:{click:t.selectDept}}),t.formData.deptName?e("input",{attrs:{type:"text",readonly:"",placeholder:"点击选择部门人员"},domProps:{value:t.formData.userName},on:{click:function(e){return t.selectUser(e)}}}):t._e(),t.multiSelectShow_r?e("multiSelect",{attrs:{multiSelectData:{data:t.userList,value:t.mainUserList_}},on:{multiSelectClose:t.multiSelectComponent_r}}):t._e()],1),e("div",{staticClass:"item"},[e("p",[t._v("协办部门")]),e("input",{attrs:{type:"text",readonly:"",placeholder:"点击选择部门"},domProps:{value:t.formData.assistName},on:{click:function(e){return t.selectAssist(e)}}}),t.multiSelectShow_x?e("multiSelect",{attrs:{multiSelectData:{data:t.assistOption,value:t.helpUserList_}},on:{multiSelectClose:t.multiSelectComponent_x}}):t._e()],1),e("div",{staticClass:"item"},[e("p",[t._v("报送领导")]),e("input",{attrs:{type:"text",readonly:"",placeholder:"点击选择报送领导"},domProps:{value:t.formData.leaderName},on:{click:function(e){return t.selectLeader(e)}}}),t.multiSelectShow?e("multiSelect",{attrs:{multiSelectData:{data:t.leaderList,value:t.leaderUserList_}},on:{multiSelectClose:t.multiSelectComponent}}):t._e()],1),e("div",{staticClass:"item"},[e("p",[t._v("处置要求")]),e("textarea",{directives:[{name:"model",rawName:"v-model.trim",value:t.formData.remark,expression:"formData.remark",modifiers:{trim:!0}}],attrs:{name:"",id:"",placeholder:"请输入处置要求"},domProps:{value:t.formData.remark},on:{input:function(e){e.target.composing||t.$set(t.formData,"remark",e.target.value.trim())},blur:function(e){return t.$forceUpdate()}}})])]):t._e(),"8"===t.i?e("div",{staticClass:"designate"},[e("div",{staticClass:"item"},[e("p",[t._v("协办部门")]),e("input",{attrs:{type:"text",readonly:"",placeholder:"点击选择部门"},domProps:{value:t.formData.assistName},on:{click:function(e){return t.selectAssist(e)}}}),t.multiSelectShow_x?e("multiSelect",{attrs:{multiSelectData:{data:t.assistOption,value:t.helpUserList_}},on:{multiSelectClose:t.multiSelectComponent_x}}):t._e()],1),e("div",{staticClass:"item"},[e("p",[t._v("报送领导")]),e("input",{attrs:{type:"text",readonly:"",placeholder:"点击选择报送领导"},domProps:{value:t.formData.leaderName},on:{click:function(e){return t.selectLeader(e)}}}),t.multiSelectShow?e("multiSelect",{attrs:{multiSelectData:{data:t.leaderList,value:t.leaderUserList_}},on:{multiSelectClose:t.multiSelectComponent}}):t._e()],1)]):t._e(),e("div",{staticClass:"endHolder"}),e("div",{staticClass:"btn"},[e("span",{on:{click:t.confirm}},[t._v("确认")])])])},s=[],n=(a("14d9"),a("6e53")),l=a("c198"),o={components:{multiSelect:n["a"]},data(){return{multiSelectShow:!1,multiSelectShow_x:!1,multiSelectShow_r:!1,leaderUserList_:[],helpUserList_:[],mainUserList_:[],i:this.$route.query.i,id:this.$route.query.id,title:"",titles:["","处置情况","申请办结","","","","指派","","","办结"],opinion:"",deptList:[],deptOption:[],userList:[],userOption:[],assistList:[],assistOption:[],leaderList:[],leaderOption:[],remark:"",formData:{remark:"",cutOffTime:"",deptName:"",userName:[],assistName:[],leaderName:[],leaderUserList:[],helpUserList:[]},files:[]}},async created(){dd.disablePullToRefresh().then(t=>{}).catch(t=>{}),this.title=this.titles[this.i];const[t,e]=await Promise.all([Object(l["Yb"])({isLeader:1}),Object(l["Yb"])({workgroupCodeId:"ZFWstab",workType:1})]);t.success&&(this.deptList=e.data.departList,this.deptOption=e.data.departList.map(t=>t.name||"-"),e.data.departList.forEach(t=>{t.userList&&t.userList.length&&t.userList.forEach(e=>{e.departmentId=t.id,this.assistList.push(e),this.assistOption.push({name:(t.name||"-")+":"+(e.name||"-"),id:e.departmentId})})}),t.data.departList.forEach(t=>{t.userList&&t.userList.length&&t.userList.forEach(t=>{this.leaderList.push(t),this.leaderOption.push(t.name)})}))},methods:{confirm(){if(1==this.i||2==this.i||9==this.i){let t={remark:this.remark,eventId:this.id,handleType:this.$route.query.handleType,handleDepartmentId:this.$route.query.handleDepartmentId,operationType:4*this.i,authName:"emergencyHandleManagement:supplementaryExplanation",editDepartmentId:this.$route.query.handleDepartmentId};9==this.i&&(t.operationType=5),this.files.length?(t.isFile=1,t.handleFileListStr=JSON.stringify(this.files)):t.isFile=0;const e=this;return void dd.device.notification.confirm({message:"确定提交?",title:"提示",buttonLabels:["取消","确定"],onSuccess(a){1===a.buttonIndex&&dd.device.notification.showPreloader({text:"提交中..",showIcon:!0,async onSuccess(a){const i=await Object(l["l"])(t);dd.device.notification.hidePreloader({onSuccess:function(t){},onFail:function(t){}}),i.success&&dd.alert({message:i.message?i.message:"操作成功",title:"提示",button:"收到"}).then(t=>{"9"!==e.i?e.$router.go(-e.i):e.$router.go(-2)}).catch(t=>{})},onFail:function(t){}})},onFail:function(t){}})}if(8==this.i){let t={dingLinkUrl:"https://pazht.ouhai.gov.cn:8000/fyDingtalkWeb/index.html#/listing/3",departmentId:this.$route.query.handleDepartmentId,eventId:this.id,editDepartmentId:this.$route.query.firstDepartmentId,operationType:2,helpUserList:this.formData.helpUserList,leaderUserList:this.formData.leaderUserList};const e=this;return void dd.device.notification.confirm({message:"是否确定新增处置?",title:"提示",buttonLabels:["取消","确定"],onSuccess(a){1===a.buttonIndex&&dd.device.notification.showPreloader({text:"处理中..",showIcon:!0,async onSuccess(a){const i=await Object(l["k"])(t);dd.device.notification.hidePreloader({onSuccess:function(t){},onFail:function(t){}}),i.success&&dd.alert({message:i.message?i.message:"操作成功",title:"提示",button:"收到"}).then(t=>{e.$router.go(-1)}).catch(t=>{})},onFail:function(t){}})},onFail:function(t){}})}if(!this.formData.userName.length)return void this.alert("请指派部门及人员");const t=this;t.formData.operationType=3,t.formData.eventId=this.id,t.formData.handleDepartmentId=this.$route.query.handleDepartmentId,t.formData.dingLinkUrl="https://pazht.ouhai.gov.cn:8000/fyDingtalkWeb/index.html#/listing/3",dd.device.notification.confirm({message:"确定指派？",title:"提示",buttonLabels:["取消","确定"],async onSuccess(e){e.buttonIndex&&dd.device.notification.showPreloader({text:"指派中..",showIcon:!0,async onSuccess(e){const a=await Object(l["k"])(t.formData);if(a.success){await Object(l["k"])({departmentId:"8d406cedc99448b3a68b7033a92487be",eventId:t.id,handleType:1,operationType:4,remark:t.formData.remark});dd.device.notification.hidePreloader({onSuccess:function(t){},onFail:function(t){}})}else dd.device.notification.hidePreloader({onSuccess:function(t){},onFail:function(t){}});a.success&&dd.alert({message:a.message?a.message:"操作成功",title:"提示",button:"收到"}).then(e=>{t.$router.go(-2)}).catch(t=>{})},onFail:function(t){}})},onFail:function(t){}})},async fileChange(t){let e=new FormData;const a=[...t.target.files];if(a&&a.length){dd.device.notification.showPreloader({text:"文件上传中..",showIcon:!0,onSuccess(t){}}),a.forEach(t=>{e.append("file",t)}),e.append("rbacToken",localStorage.getItem("rbacToken")),dd.device.notification.hidePreloader({onSuccess:function(t){},onFail:function(t){}});const t=await Object(l["gc"])(e);t.success&&t.data&&t.data.length&&t.data.forEach((t,e)=>{var i={};i.fileType=a[e].type,i.fileName=a[e].name,i.fileId=t,this.files.push(i)})}},delFile(t){this.files.splice(t,1)},selectTime(){const t=this,e=new Date;e.getFullYear(),String(e.getMonth()+1).padStart(2,0),String(e.getDate()).padStart(2,0);dd.showDatePicker({format:"yyyy-MM-dd",value:t.formData.incidentTime}).then(e=>{t.formData.cutOffTime=e.value}).catch(t=>{})},selectDept(){const t=this;dd.device.notification.actionSheet({title:"选择指派部门？",cancelButton:"取消",otherButtons:t.deptOption,onSuccess:function(e){-1!==e.buttonIndex&&(t.formData.userName=[],t.formData.operationId=t.deptList[e.buttonIndex].id,t.formData.departmentId=t.deptList[e.buttonIndex].id,t.formData.deptName=t.deptOption[e.buttonIndex],t.userList=t.deptList[e.buttonIndex].userList,t.userOption=t.userList.map(t=>t.name))},onFail:function(t){}})},multiSelectComponent_r(t){let e=this;e.multiSelectShow_r=t.status,e.mainUserList_=t.data;let a=[],i=[];e.userList&&e.userList.length>0&&t.data&&t.data.length>0&&e.userList.map((e,s)=>{t.data.map((t,s)=>{e.id==t&&(i.push(e),a.push(e.name))})}),e.formData.userName=a,e.formData.mainUserList=i},selectUser(){const t=this;t.multiSelectShow_r=!0},multiSelectComponent_x(t){let e=this;e.multiSelectShow_x=t.status,e.helpUserList_=t.data,e.formData.assistName=t.nameArr;let a=[];e.assistList&&e.assistList.length>0&&t.data&&t.data.length>0&&e.assistList.map((e,i)=>{t.data.map((t,i)=>{e.departmentId==t&&a.push(e)})}),e.formData.helpUserList=a},selectAssist(t){t.stopPropagation();const e=this;e.multiSelectShow_x=!0},multiSelectComponent(t){let e=this;e.multiSelectShow=t.status,e.leaderUserList_=t.data;let a=[],i=[];e.leaderList&&e.leaderList.length>0&&t.data&&t.data.length>0&&e.leaderList.map((e,s)=>{t.data.map((t,s)=>{e.id==t&&(i.push(e),a.push(e.name))})}),e.formData.leaderName=a,e.formData.leaderUserList=i},selectLeader(t){t.stopPropagation();const e=this;e.multiSelectShow=!0},alert(t){dd.device.notification.alert({message:t,title:"提示",buttonName:"确定"})}}},r=o,c=(a("d1ef"),a("2877")),d=Object(c["a"])(r,i,s,!1,null,"f8c0342a",null);e["default"]=d.exports},"6b314":function(t,e,a){},"6e53":function(t,e,a){"use strict";var i=function(){var t=this,e=t._self._c;return e("div",{staticClass:"multiSelect"},[e("van-popup",{staticStyle:{height:"50%"},attrs:{closeable:"",round:"",position:"bottom"},on:{closed:t.multiSelectClose},model:{value:t.multiSelect_show,callback:function(e){t.multiSelect_show=e},expression:"multiSelect_show"}},[e("van-checkbox-group",{attrs:{"icon-size":"20px"},model:{value:t.multiSelect_value,callback:function(e){t.multiSelect_value=e},expression:"multiSelect_value"}},t._l(t.multiSelect_Data,(function(a){return e("van-checkbox",{key:a.id,attrs:{name:a.id}},[t._v(t._s(a.name))])})),1)],1)],1)},s=[],n=(a("14d9"),{props:["multiSelectData"],data(){return{multiSelect_show:!0,multiSelect_Data:this.multiSelectData.data.length>0?this.multiSelectData.data:[],multiSelect_value:this.multiSelectData.value}},created(){},mounted(){},methods:{multiSelectClose(){let t=this,e=[];t.multiSelect_Data&&t.multiSelect_Data.length>0&&t.multiSelect_value&&t.multiSelect_value.length>0&&t.multiSelect_Data.map((a,i)=>{t.multiSelect_value.map((t,i)=>{a.id==t&&e.push(a.name)})}),t.$emit("multiSelectClose",{data:t.multiSelect_value,status:!1,nameArr:e})}}}),l=n,o=a("2877"),r=Object(o["a"])(l,i,s,!1,null,"7855c86c",null);e["a"]=r.exports},d1ef:function(t,e,a){"use strict";a("6b314")}}]);