(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-54276502"],{"3bb7":function(t,e,i){"use strict";i("c27e")},"66af":function(t,e,i){"use strict";i.r(e);var a=function(){var t=this,e=t._self._c;return e("div",{staticClass:"hiddenReportMaxbox"},[e("div",{staticStyle:{height:"50vh",width:"100%"}},[1==t.pageType?e("Map",{attrs:{disable:2==t.pageType},on:{getInfo:function(e){return t.getMapinfo(e)}}}):e("Map",{attrs:{disable:2==t.pageType,Pointpos:[t.uploadinfo.longitude,t.uploadinfo.latitude]},on:{getInfo:function(e){return t.getMapinfo(e)}}})],1),e("div",{staticClass:"contentBox"},[e("div",{staticStyle:{display:"flex","justify-content":"space-between"}},[e("div",{staticClass:"contentTitle"},[t._v("点位信息")]),2==t.pageType?e("div",{staticStyle:{width:"19vw"}},[e("div",{staticClass:"StatusBox",style:{backgroundColor:5==t.uploadinfo.eventState||6==t.uploadinfo.eventState?"#c4c4c4":"#5DC687"}},[t._v(" "+t._s(t.uploadinfo.eventStateName)+" ")])]):t._e()]),e("div",{staticClass:"contentForm"},[t._m(0),e("div",{staticClass:"shellBox",staticStyle:{width:"75%"}},[2!=t.pageType?e("input",{directives:[{name:"model",rawName:"v-model",value:t.uploadinfo.locationAddress,expression:"uploadinfo.locationAddress"}],staticStyle:{padding:"5px 8px",width:"100%","background-color":"white"},style:{color:""==t.uploadinfo.locationAddress?"#E4E4E4":"black"},attrs:{disabled:!0,placeholder:"请在地图上取点选择"},domProps:{value:t.uploadinfo.locationAddress},on:{input:function(e){e.target.composing||t.$set(t.uploadinfo,"locationAddress",e.target.value)}}}):e("div",{staticClass:"scrollBarBox"},[t._v(" "+t._s(t.uploadinfo.locationAddress)+" ")])])]),e("div",{staticClass:"contentForm"},[t._m(1),e("div",{staticClass:"shellBox",staticStyle:{width:"75%"}},[e("popSelect",{attrs:{muiltdate:t.streetList,exisVal:t.uploadinfo.orgRoadName,placehold:"请选择镇街",disable:2==t.pageType,bindkey:"name"},on:{ValChange:function(e){return t.onChange(e)}}},[e("div",[t._v("1")])])],1)]),e("div",{staticClass:"contentForm"},[t._m(2),e("div",{staticClass:"shellBox",staticStyle:{width:"75%"}},[2!=t.pageType?e("input",{directives:[{name:"model",rawName:"v-model",value:t.uploadinfo.pointName,expression:"uploadinfo.pointName"}],staticStyle:{padding:"5px 8px",width:"100%","background-color":"white"},style:{color:""==t.uploadinfo.pointName?"#E4E4E4":"black"},attrs:{placeholder:"请输入点位名称"},domProps:{value:t.uploadinfo.pointName},on:{input:function(e){e.target.composing||t.$set(t.uploadinfo,"pointName",e.target.value)}}}):e("div",{staticClass:"scrollBarBox"},[t._v(t._s(t.uploadinfo.pointName))])])]),e("div",{staticClass:"contentForm",staticStyle:{"align-items":"flex-start","margin-bottom":"0px"}},[t._m(3),e("div",{staticStyle:{width:"75%"}},[e("imgUp",{ref:"imgDom",attrs:{disable:2==t.pageType,filelist:t.pointImgUrls},on:{getimgId:function(e){return t.getimginfo(e)}}})],1)])]),e("div",{staticClass:"contentBox"},[e("div",{staticClass:"contentTitle"},[t._v("隐患信息")]),t._l(t.HiddenDangerInfo,(function(a,n){return e("div",{key:n,staticClass:"HiddenDangerDetailBox",on:{click:function(e){2==t.pageType?t.$push("/SecretVisit/HiddenDangerDetail/HiddenDangerDetail",{Status:a.state,eventState:t.uploadinfo.eventState,HiddenDangerId:a.id,hidedangSize:t.HiddenDangerInfo.length}):t.$push("/SecretVisit/HiddenDangerAdded/HiddenDangerAdded",{infoId:n+1})}}},[e("div",{staticStyle:{width:"28%"}},[2==t.pageType?e("img",{staticStyle:{width:"25vw",height:"25vw"},attrs:{src:a["picIds"][0]}}):e("img",{staticStyle:{width:"25vw",height:"25vw"},attrs:{src:a.imginfo["url"][0]}})]),e("div",{staticStyle:{width:"50%"}},[e("div",{staticStyle:{color:"#9A8D8E","font-weight":"bold","margin-top":"10px","margin-bottom":"8px"}},[t._v(" 隐患描述 ")]),e("div",{staticStyle:{color:"#9A8D8E"}},[t._v(" "+t._s(a.description.length>25?a.description.substring(0,20)+"......":a.description)+" ")])]),e("div",{staticClass:"delIcon"},[1==t.pageType?e("img",{attrs:{src:i("d44a")},on:{click:function(e){return e.stopPropagation(),t.removeHideDanger(n)}}}):e("div",{staticStyle:{width:"20vw","text-align":"center","line-height":"20px",color:"white","border-radius":"4px"},style:{backgroundColor:1==a.state||7==a.state?"#C4C4C5":2==a.start||6==a.start?"#5dc687":"#ffc900"}},[t._v(" "+t._s(a.stateName)+" ")])])])})),e("div",[1==t.pageType?e("div",{staticClass:"butStyle_color-gray",staticStyle:{"margin-top":"25px"},on:{click:t.gotoaddPage}},[t._v(" 添加隐患 ")]):t._e()])],2),2==t.pageType?e("div",{staticClass:"contentBox"},[e("div",{staticClass:"contentTitle"},[t._v("流转信息")]),e("div",{staticClass:"contentForm"},[e("div",{staticClass:"content_label"},[t._v("上报时间")]),e("div",{staticStyle:{width:"75%"}},[t._v(" "+t._s(t.uploadinfo.reportTime)+" ")])]),6!=t.pointinfoType&&1!=t.pointinfoType?e("div",{staticClass:"contentForm"},[e("div",{staticClass:"content_label"},[t._v("指派时间")]),e("div",{staticStyle:{width:"75%"}},[t._v(" "+t._s(t.uploadinfo.assignTime)+" ")])]):t._e(),6!=t.pointinfoType&&1!=t.pointinfoType&&2!=t.pointinfoType?e("div",{staticClass:"contentForm"},[e("div",{staticClass:"content_label"},[t._v("提交审核")]),e("div",{staticStyle:{width:"75%"}},[t._v(" "+t._s(t.uploadinfo.approveTime)+" ")])]):t._e(),5==t.pointinfoType?e("div",{staticClass:"contentForm"},[e("div",{staticClass:"content_label"},[t._v("办结时间")]),e("div",{staticStyle:{width:"75%"}},[t._v(" "+t._s(t.uploadinfo.finishTime)+" ")])]):t._e(),6==t.pointinfoType?e("div",{staticClass:"contentForm"},[e("div",{staticClass:"content_label"},[t._v("撤销时间")]),e("div",{staticStyle:{width:"75%"}},[t._v(" "+t._s(t.uploadinfo.revokeTime)+" ")])]):t._e()]):t._e(),e("div",{staticStyle:{"padding-bottom":"15vh"}}),e("div",{staticClass:"newButton-submit-botBox"},[2==t.groupType&&2==t.pointinfoType?e("div",{staticClass:"butStyle_color-green",on:{click:t.submitReview}},[t._v(" 提交审核 ")]):1==t.pageType?e("div",{staticClass:"butStyle_color-green",on:{click:t.upInfo}},[t._v(" 提交 ")]):e("div",{staticClass:"butStyle_color-green",on:{click:function(e){return t.window.history.go(-1)}}},[t._v(" 返回 ")])])])},n=[function(){var t=this,e=t._self._c;return e("div",{staticClass:"content_label"},[e("span",[t._v("*")]),t._v("地点定位")])},function(){var t=this,e=t._self._c;return e("div",{staticClass:"content_label"},[e("span",[t._v("*")]),t._v("所属镇街")])},function(){var t=this,e=t._self._c;return e("div",{staticClass:"content_label"},[e("span",[t._v("*")]),t._v("点位名称")])},function(){var t=this,e=t._self._c;return e("div",{staticClass:"content_label",staticStyle:{"margin-top":"19px"}},[e("span",[t._v("*")]),t._v("照片信息")])}],s=(i("14d9"),i("2241")),o=i("f564"),d=function(){var t=this,e=t._self._c;return e("div",{staticClass:"multiSelectOdd"},[e("div",{staticStyle:{padding:"5px 8px"},on:{click:t.openPop}},[""!=t.val||t.disable?e("span",[t._v(t._s(t.val||t.exisVal))]):e("span",{staticStyle:{color:"#d3cddb"}},[t._v(t._s(t.placehold))])]),e("van-popup",{staticStyle:{height:"50%"},attrs:{round:"",position:"bottom"},model:{value:t.multiSelect_show,callback:function(e){t.multiSelect_show=e},expression:"multiSelect_show"}},[e("div",{staticClass:"multiSelectOdd_content"},[e("div",{staticClass:"multiSelectOdd_content_div"},[e("p",{staticClass:"multiSelectOdd_content_line0"},[t._v("请选择")]),t._l(t.muiltdate,(function(i,a){return e("p",{key:a,staticClass:"multiSelectOdd_content_line",on:{click:function(e){return t.multiSelectOddReturn(i)}}},[t._v(t._s(i[t.bindkey]))])}))],2),e("div",{staticClass:"close"},[e("div",{staticStyle:{height:"10px",background:"#e6e6e6","margin-bottom":"25px"}}),e("div",{staticStyle:{padding:"10px 0px"},on:{click:t.multiSelectOddReturn_}},[t._v("取消")])])])])],1)},l=[],c={props:{muiltdate:{type:Array,default:[]},bindkey:{type:String,default:"name"},disable:{tyep:Boolean,default:!1},placehold:{type:String,default:"请输入"},exisVal:{type:String,default:""}},watch:{exisVal(t){this.val=t}},data(){return{val:"",multiSelect_show:!1}},methods:{openPop(){this.disable||(this.multiSelect_show=!0)},Valchange(t){this.$emit("ValChange",t),this.multiSelect_show=!1},multiSelectOddReturn_(){this.multiSelect_show=!1},multiSelectOddReturn(t){this.val=t[this.bindkey],this.Valchange(t)}}},r=c,p=(i("3bb7"),i("2877")),u=Object(p["a"])(r,d,l,!1,null,"67bef06f",null),g=u.exports,h=function(){var t=this,e=t._self._c;return e("div",{staticStyle:{width:"100%",height:"100%",position:"relative"}},[e("div",{attrs:{id:"container"}}),e("div",{staticClass:"newpos",on:{click:function(e){t.disable?t.init():t.getLocation()}}})])},v=[],m={data(){return{center:[120.986297,28.112519],mapobj:null,localName:""}},props:{disable:{type:Boolean,default:!1},Pointpos:{type:Array||null,default:()=>[120.986297,28.112519]}},watch:{disable(t){this.init()},Pointpos(t){void 0!=t[0]&&(this.center=t,this.init())}},mounted(){this.getLocation()},methods:{getLocation(){const t=this;dd.getGeolocation({targetAccuracy:200,coordinate:1,withReGeocode:!0,useCache:!0}).then(e=>{t.center=[e.longitude,e.latitude],t.getAddress(t),t.init(t)}).catch(e=>{Object(o["a"])({type:"danger",message:e.errorMessage}),t.center=[120.986297,28.112519],t.init(),t.getAddress(t)})},init(t){const e=this||t;var i=new AMap.Map("container",{viewMode:"2D",zoom:17,center:e.center,resizeEnable:!0}),a=new AMap.Marker({icon:"https://webapi.amap.com/theme/v1.3/markers/n/mark_b.png",position:e.center,draggable:!0,offset:new AMap.Pixel(-13,-30)});AMap.plugin(["AMap.ToolBar"],(function(){i.addControl(new AMap.ToolBar({liteStyle:!0}))})),i.add(a),e.disable||i.on("click",(function(t){i.remove([a]),e.center=[t.lnglat.lng,t.lnglat.lat],a=new AMap.Marker({icon:"https://webapi.amap.com/theme/v1.3/markers/n/mark_b.png",position:[t.lnglat.lng,t.lnglat.lat],offset:new AMap.Pixel(-10,-20)}),i.add([a]),e.getAddress(e)}))},getAddress(t){const e=t;var i=new AMap.Geocoder({city:"全国",radius:1e3});i.getAddress(e.center,(function(i,a){if("complete"===i&&a.regeocode){var n=a.regeocode.formattedAddress;e.localName=n,e.sendinfo(t)}}))},sendinfo(t){const e=this||t;e.$emit("getInfo",{lon:e.center[0],lat:e.center[1],addName:e.localName})}}},f=m,y=(i("cb68"),Object(p["a"])(f,h,v,!1,null,null,null)),_=y.exports,b=i("60b2"),S=i("c198"),w={name:"HiddenDangerReported",components:{popSelect:g,Map:_,imgUp:b["a"]},data(){return{streetList:[{name:"al"}],selectShow:!1,pageType:-1,eventid:0,pointinfoType:0,groupType:0,window:window,HiddenDangerInfo:[],pointImgUrls:[],conversionTimeArrys:["reportTime","assignTime","approveTime","finishTime","revokeTime"],uploadinfo:{},timeOut:null}},activated(){1==this.pageType?this.getHiddenDangerList():this.getPointEventDetail()},mounted(){"detail"==this.$route.query.type?(this.pageType=2,this.eventid=this.$route.query.eventID,this.pointinfoType=this.$route.query.eventState,this.groupType=this.$store.state.groupType,this.getPointEventDetail()):(this.pageType=1,this.getHiddenDangerList()),this.$store.commit("StoreData",{key:"includeArry",value:["HiddenDangerReported"]}),this.getStreetList()},methods:{getTypeList_13:S["Ib"],upload:S["gc"],onChange(t){this.uploadinfo.orgRoad=t.id,this.uploadinfo.orgRoadName=t.name},getMapinfo(t){2!=this.pageType&&(this.uploadinfo.latitude=t.lat,this.uploadinfo.longitude=t.lon,this.uploadinfo.locationAddress=t.addName,this.$forceUpdate())},async getimginfo(t,e){let i=this.$utils.getString(t,",");this.uploadinfo["picIds"]=i},getHiddenDangerList(){1==this.pageType?this.HiddenDangerInfo=this.$store.state.HiddenDangerInfo:this.getPointEventDetail()},getPointEventDetail(){this.$httpapi.getPointEventDetail({pageSize:20,pageNo:1,id:this.eventid,eventState:this.pointinfoType}).then(t=>{if(1==t.success){this.HiddenDangerInfo=t.data.hiddenTroubleList,this.pointinfoType=t.data.eventState,this.HiddenDangerInfo.map((t,e)=>{let i=this.$utils.relimgUrl(t.picIds,!0);return t.picIds=i}),this.uploadinfo=t.data;let e=this.$utils.relimgUrl(t.data.picIds,!0);this.pointImgUrls=e}else"查询失败,请联系管理员"==t.message&&this.$router.go(-1)})},removeHideDanger(t){s["a"].confirm({title:"确认删除",width:"250px"}).then(e=>{let i=this.$store.state.HiddenDangerInfo;i.splice(t,1),this.$store.commit("StoreData",{key:"HiddenDangerInfo",value:[...i]})})},async getStreetList(){let t=await this.getTypeList_13({type:13});this.streetList=t.data},async upInfo(){if(""==this.uploadinfo.orgRoadName||void 0==this.uploadinfo.orgRoadName)return void Object(o["a"])({type:"danger",message:"所属镇街未选择"});if(""==this.uploadinfo.pointName||void 0==this.uploadinfo.pointName)return void Object(o["a"])({type:"danger",message:"点位名称不能为空"});const t=this;if(this.$refs.imgDom.sendInfo3(),""==this.uploadinfo.picIds||void 0==this.uploadinfo.picIds)return void Object(o["a"])({type:"danger",message:"照片信息不能为空"});let e=[...this.HiddenDangerInfo],i=[];e.map((e,a)=>{let n={picIds:null,description:null},s=t.$utils.getString(e.imginfo.id,",");n.description=e.description,n.picIds=s,i.push(n)}),this.Load.showLoad(),this.$httpapi.addPointLocationEvent({...this.uploadinfo,hiddenTroubleList:[...i]}).then(t=>{this.Load.hideLoad(),1==t.success?setTimeout(()=>{this.$router.go(-1)},200):Object(o["a"])({type:"danger",message:t.message})})},submitReview(){this.$httpapi.checkApproveHiddenTrouble({businessKey:this.uploadinfo.id,operation:"commit"}).then(t=>{1==t.success?(Object(o["a"])({type:"success",message:"提交成功"}),setTimeout(()=>{this.$router.go(-1)},500)):Object(o["a"])({type:"danger",message:t.message})})},gotoaddPage(){this.$refs.imgDom.sendInfo(),this.$push("/SecretVisit/HiddenDangerAdded/HiddenDangerAdded")}}},T=w,C=(i("9386"),Object(p["a"])(T,a,n,!1,null,"c3a0a2c0",null));e["default"]=C.exports},"672f":function(t,e,i){},9386:function(t,e,i){"use strict";i("d1fb")},c27e:function(t,e,i){},cb68:function(t,e,i){"use strict";i("672f")},d1fb:function(t,e,i){},d44a:function(t,e,i){t.exports=i.p+"static/img/del2.31615ea9.png"}}]);