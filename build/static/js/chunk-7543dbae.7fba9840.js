(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-7543dbae"],{"0a9d":function(t,e,a){"use strict";a.r(e);var s=function(){var t=this,e=t._self._c;return e("div",{staticClass:"reportedAdd_warp"},[e("div",{staticClass:"form",class:t.edit?"":"unclick"},[e("div",{staticClass:"item"},[e("p",{class:t.formData.emphasesPeopleIdName?"active":""},[t._v("重点人")]),e("div",[e("input",{directives:[{name:"model",rawName:"v-model",value:t.formData.emphasesPeopleIdName,expression:"formData.emphasesPeopleIdName"}],attrs:{readonly:"",type:"text",placeholder:"点击选择重点人"},domProps:{value:t.formData.emphasesPeopleIdName},on:{click:t.select_emphasesPeopleId,input:function(e){e.target.composing||t.$set(t.formData,"emphasesPeopleIdName",e.target.value)}}})])]),t.address_?e("div",{staticClass:"item"},[e("p",{class:t.address_?"active":""},[t._v("居住地")]),e("div",[e("input",{directives:[{name:"model",rawName:"v-model",value:t.address_,expression:"address_"}],attrs:{readonly:"",type:"text"},domProps:{value:t.address_},on:{input:function(e){e.target.composing||(t.address_=e.target.value)}}})])]):t._e(),t.phone_?e("div",{staticClass:"item"},[e("p",{class:t.phone_?"active":""},[t._v("联系方式")]),e("div",[e("input",{directives:[{name:"model",rawName:"v-model",value:t.phone_,expression:"phone_"}],attrs:{readonly:"",type:"text"},domProps:{value:t.phone_},on:{input:function(e){e.target.composing||(t.phone_=e.target.value)}}})])]):t._e(),e("div",{staticClass:"item"},[e("p",{class:t.formData.address?"active":""},[t._v("详细地址")]),e("div",{staticClass:"address"},[e("input",{directives:[{name:"model",rawName:"v-model",value:t.formData.address,expression:"formData.address"}],attrs:{type:"text",placeholder:"点击选择详细地址",readonly:""},domProps:{value:t.formData.address},on:{input:function(e){e.target.composing||t.$set(t.formData,"address",e.target.value)}}}),e("i",{staticClass:"iconfont icon-location",on:{click:function(e){return t.geolocation()}}})])]),e("div",{staticClass:"item"},[e("p",{class:t.formData.isMeet?"active":""},[t._v("是否见面")]),e("div",[e("input",{directives:[{name:"model",rawName:"v-model",value:t.isMeetName,expression:"isMeetName"}],attrs:{readonly:"",type:"text",placeholder:"点击选择是否见面"},domProps:{value:t.isMeetName},on:{click:t.select_isMeet,input:function(e){e.target.composing||(t.isMeetName=e.target.value)}}})])]),e("div",{staticClass:"item incidentContent"},[e("p",{class:t.formData.content?"active":""},[t._v("描述")]),e("div",[e("textarea",{directives:[{name:"model",rawName:"v-model.trim",value:t.formData.content,expression:"formData.content",modifiers:{trim:!0}}],staticStyle:{width:"100%"},attrs:{name:"",id:"",cols:"30",rows:"5",placeholder:"在此输入描述"},domProps:{value:t.formData.content},on:{input:function(e){e.target.composing||t.$set(t.formData,"content",e.target.value.trim())},blur:function(e){return t.$forceUpdate()}}})])]),e("div",{staticClass:"item"},[e("p",{class:t.formData.files.length>0?"active":""},[t._v("照片")]),e("div",{staticClass:"item_main"},[t._l(t.formData.files,(function(a,s){return e("span",{key:s,staticStyle:{position:"relative"}},[e("img",{attrs:{src:t.url_+"rbac/file/downloadRb/"+a+"?rbacToken="+t.rbacToken_+"&isSmall=1"}}),e("i",{staticClass:"iconfont icon-cha2",on:{click:function(e){return t.delFile(t.i)}}})])})),t.formData.files.length<5?e("span",[e("button",{staticStyle:{background:"#d7d7d7"}},[t._v(" 上传 "),e("input",{attrs:{multiple:"",type:"file",name:"",id:""},on:{change:t.fileChange}})])]):t._e()],2)])]),e("div",{staticClass:"endHolder"}),e("div",{staticClass:"btn"},[e("span",{on:{click:function(e){return t.handClick()}}},[t._v("提交")])])])},n=[],i=(a("14d9"),a("c198")),o=a("b893"),r={data(){return{url_:"",rbacToken_:"",edit:!0,phone_:"",address_:"",isMeetName:"",formData:{emphasesPeopleId:"",emphasesPeopleIdName:"",isMeet:"",address:"",x:"",y:"",content:"",files:[]},getEmphPeopleList:[],getEmphPeopleListName:[]}},computed:{},async created(){let t=this;dd.disablePullToRefresh(),t.url_=Object({NODE_ENV:"production",VUE_APP_ENV:"production",BASE_URL:""}).baseUrl,t.rbacToken_=t.$store.getters.rbacToken||localStorage.getItem("rbacToken");const e=await Object(i["U"])();e.success&&(t.getEmphPeopleList=e.data,e.data.map((e,a)=>{t.getEmphPeopleListName.push(e.name)})),t.geolocation()},methods:{geolocation(){let t=this;dd.getGeolocation({targetAccuracy:200,coordinate:1,withReGeocode:!0,useCache:!1}).then(e=>{t.formData.address=e.address;var a=o["a"].gcj_decrypt(e.latitude,e.longitude);t.formData.x=a.lon,t.formData.y=a.lat}).catch(t=>{})},select_emphasesPeopleId(){const t=this;dd.device.notification.actionSheet({title:"选择重点人？",cancelButton:"取消",otherButtons:t.getEmphPeopleListName,onSuccess:function(e){-1!==e.buttonIndex&&(t.formData.emphasesPeopleId=t.getEmphPeopleList[e.buttonIndex].id,t.formData.emphasesPeopleIdName=t.getEmphPeopleList[e.buttonIndex].name,t.address_=t.getEmphPeopleList[e.buttonIndex].address?t.getEmphPeopleList[e.buttonIndex].address:"暂无居住地信息",t.phone_=t.getEmphPeopleList[e.buttonIndex].phone?t.getEmphPeopleList[e.buttonIndex].phone:"暂无手机号信息")},onFail:function(t){}})},select_isMeet(){const t=this;dd.device.notification.actionSheet({title:"是否见面？",cancelButton:"取消",otherButtons:["否","是"],onSuccess:function(e){-1!==e.buttonIndex&&(t.formData.isMeet=e.buttonIndex,t.isMeetName=1==e.buttonIndex?"是":"否")},onFail:function(t){}})},cancel(){this.$router.go(-1)},handClick(){const t=this;return""==t.formData.emphasesPeopleId?(t.alert("请选择重点人"),!1):""==t.formData.address?(t.alert("请选择详细地址"),!1):t.formData.isMeet||0==t.formData.isMeet?""==t.formData.content?(t.alert("请输入描述"),!1):0==t.formData.files.length?(t.alert("请上传图片"),!1):void dd.device.notification.confirm({message:"确定上报？",title:"提示",buttonLabels:["取消","确定"],async onSuccess(e){e.buttonIndex&&dd.device.notification.showPreloader({text:"提交中..",showIcon:!0,async onSuccess(e){const a=await Object(i["p"])(t.formData);dd.device.notification.hidePreloader({}),a.success&&dd.device.notification.toast({icon:"",text:"操作成功",duration:2,delay:0,onSuccess(e){t.$router.go(-1)},onFail:function(t){}})},onFail:function(t){}})},onFail:function(t){}}):(t.alert("请选择是否见面"),!1)},async fileChange(t){let e=new FormData;const a=[...t.target.files];if(a&&a.length){if(a.length>5)return this.alert("最多只能上传5张"),!1;a.forEach((t,a)=>{e.append("file",t)}),dd.device.notification.showPreloader({text:"文件上传中..",showIcon:!0,onSuccess(t){}}),e.append("rbacToken",localStorage.getItem("rbacToken")),e.append("isSmall","1");const t=await Object(i["gc"])(e);dd.device.notification.hidePreloader({}),t.success&&t.data.map((t,e)=>{this.formData.files.push(t)})}},delFile(t){this.formData.files.splice(t,1)},alert(t){dd.device.notification.alert({message:t,title:"提示",buttonName:"确定"})}}},c=r,l=(a("60f2"),a("2877")),d=Object(l["a"])(c,s,n,!1,null,"37a8434e",null);e["default"]=d.exports},"60f2":function(t,e,a){"use strict";a("e330a")},b893:function(t,e,a){"use strict";a.d(e,"a",(function(){return s}));const s={PI:3.141592653589793,x_pi:52.35987755982988,delta:function(t,e){var a=6378245,s=.006693421622965943,n=this.transformLat(e-105,t-35),i=this.transformLon(e-105,t-35),o=t/180*this.PI,r=Math.sin(o);r=1-s*r*r;var c=Math.sqrt(r);return n=180*n/(a*(1-s)/(r*c)*this.PI),i=180*i/(a/c*Math.cos(o)*this.PI),{lat:n,lon:i}},gcj_encrypt:function(t,e){if(this.outOfChina(t,e))return{lat:t,lon:e};var a=this.delta(t,e);return{lat:t+a.lat,lon:e+a.lon}},gcj_decrypt:function(t,e){if(this.outOfChina(t,e))return{lat:t,lon:e};var a=this.delta(t,e);return{lat:t-a.lat,lon:e-a.lon}},gcj_decrypt_exact:function(t,e){var a,s,n=.01,i=1e-9,o=n,r=n,c=t-o,l=e-r,d=t+o,h=e+r,m=0;while(1){a=(c+d)/2,s=(l+h)/2;var u=this.gcj_encrypt(a,s);if(o=u.lat-t,r=u.lon-e,Math.abs(o)<i&&Math.abs(r)<i)break;if(o>0?d=a:c=a,r>0?h=s:l=s,++m>1e4)break}return{lat:a,lon:s}},bd_encrypt:function(t,e){var a=e,s=t,n=Math.sqrt(a*a+s*s)+2e-5*Math.sin(s*this.x_pi),i=Math.atan2(s,a)+3e-6*Math.cos(a*this.x_pi);return bdLon=n*Math.cos(i)+.0065,bdLat=n*Math.sin(i)+.006,{lat:bdLat,lon:bdLon}},bd_decrypt:function(t,e){var a=e-.0065,s=t-.006,n=Math.sqrt(a*a+s*s)-2e-5*Math.sin(s*this.x_pi),i=Math.atan2(s,a)-3e-6*Math.cos(a*this.x_pi),o=n*Math.cos(i),r=n*Math.sin(i);return{lat:r,lon:o}},mercator_encrypt:function(t,e){var a=20037508.34*e/180,s=Math.log(Math.tan((90+t)*this.PI/360))/(this.PI/180);return s=20037508.34*s/180,{lat:s,lon:a}},mercator_decrypt:function(t,e){var a=e/20037508.34*180,s=t/20037508.34*180;return s=180/this.PI*(2*Math.atan(Math.exp(s*this.PI/180))-this.PI/2),{lat:s,lon:a}},distance:function(t,e,a,s){var n=6371e3,i=Math.cos(t*this.PI/180)*Math.cos(a*this.PI/180)*Math.cos((e-s)*this.PI/180),o=Math.sin(t*this.PI/180)*Math.sin(a*this.PI/180),r=i+o;r>1&&(r=1),r<-1&&(r=-1);var c=Math.acos(r),l=c*n;return l},outOfChina:function(t,e){return e<72.004||e>137.8347||(t<.8293||t>55.8271)},transformLat:function(t,e){var a=2*t-100+3*e+.2*e*e+.1*t*e+.2*Math.sqrt(Math.abs(t));return a+=2*(20*Math.sin(6*t*this.PI)+20*Math.sin(2*t*this.PI))/3,a+=2*(20*Math.sin(e*this.PI)+40*Math.sin(e/3*this.PI))/3,a+=2*(160*Math.sin(e/12*this.PI)+320*Math.sin(e*this.PI/30))/3,a},transformLon:function(t,e){var a=300+t+2*e+.1*t*t+.1*t*e+.1*Math.sqrt(Math.abs(t));return a+=2*(20*Math.sin(6*t*this.PI)+20*Math.sin(2*t*this.PI))/3,a+=2*(20*Math.sin(t*this.PI)+40*Math.sin(t/3*this.PI))/3,a+=2*(150*Math.sin(t/12*this.PI)+300*Math.sin(t/30*this.PI))/3,a}}},e330a:function(t,e,a){}}]);