(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-5748e08c"],{"28b1":function(t,e,a){"use strict";a.r(e);var s=function(){var t=this,e=t._self._c;return e("div",{staticClass:"safety_warp"},[e("div",{staticClass:"header"},[e("div",{staticClass:"header_left"},[e("span",{on:{click:t.selectStreet}},[t._v(" "+t._s(t.params.roadName?t.params.roadName:"点击选择检查单位")+" ")]),e("span",[t._v(t._s(t.rectifyCount)+"/"+t._s(t.total))])]),e("form",{staticClass:"search",attrs:{action:"."}},[e("input",{staticStyle:{display:"none"},attrs:{type:"text"}}),e("input",{directives:[{name:"model",rawName:"v-model",value:t.keyword,expression:"keyword"}],ref:"input",attrs:{type:"search",placeholder:"请输入搜索单位"},domProps:{value:t.keyword},on:{keydown:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.search.apply(null,arguments)},input:function(e){e.target.composing||(t.keyword=e.target.value)}}}),e("i",{staticClass:"iconfont icon-sousuo"})])]),e("ul",{directives:[{name:"infinite-scroll",rawName:"v-infinite-scroll",value:t.loadMore,expression:"loadMore"}],staticClass:"list",attrs:{"infinite-scroll-disabled":"loading","infinite-scroll-distance":"10"}},t._l(t.list,(function(a,s){return e("li",{key:s,on:{click:function(e){return t.toDetail(a.id)}}},[e("div",[e("h4",[t._v(t._s(a.checkTarget))]),e("i",[e("s",{style:{color:a.rectifyStatus?"green":""}},[t._v(t._s(a.rectifyStatus?"已整改":"未整改"))])])]),e("div",[e("span",[t._v(t._s(a.roadName))]),e("i",[e("b",{staticClass:"iconfont icon-time"}),e("s",[t._v(t._s(a.incidentTime?a.incidentTime.split(" ")[0]:""))])])])])})),0),e("div",{staticClass:"report",on:{click:t.add}},[e("i",{staticClass:"iconfont icon-daohanglan"}),e("p",[t._v("上报")])])])},i=[],n=(a("14d9"),a("c198")),o={name:"safety",data(){return{keyword:"",pageSize:10,loading:!1,noMore:!1,tabIndex:localStorage.getItem("safetyTabIndex")/1||1,subTabIndex:localStorage.getItem("safetySubIndex")/1||1,list:[],total:0,rectifyCount:0,params:{pageNo:1,type:2,teamworkType:6,authName:"peaceIncident:statisticsManagement",parentAuthName:"peaceIncident:statisticsManagement",roadId:"",roadName:""}}},computed:{streetList(){return this.$store.state.common.streetList}},async created(){const t=this;dd.enablePullToRefresh().then(e=>{t.getData()}).catch(t=>{dd.stopPullToRefresh()}),t.getData()},methods:{selectStreet(){const t=this;let e=t.streetList.map(t=>t.name);e.unshift("请选择所属街道"),dd.device.notification.actionSheet({title:"选择检查单位？",cancelButton:"取消",otherButtons:e,onSuccess:function(e){-1!==e.buttonIndex&&(t.params.roadId=0==e.buttonIndex?null:t.streetList[e.buttonIndex-1].id,t.params.roadName=0==e.buttonIndex?"请选择所属街道":t.streetList[e.buttonIndex-1].name,t.getData())},onFail:function(t){}})},async getData(){const t=this,e=await Object(n["zb"])({type:2,keyword:t.keyword,roadId:t.params.roadId});t.rectifyCount=e.data.rectifyCount,t.params.keyword=t.keyword,t.params.teamworkType=5,t.params.pageSize=t.pageSize;const a=await Object(n["xb"])(t.params);a.success?(t.list=a.data.list,t.total=a.data.total,dd.stopPullToRefresh()):(t.list=[],t.total=0,dd.stopPullToRefresh())},search(){this.getData(),this.$refs.input.blur()},changeIndex(t){this.tabIndex=t,localStorage.setItem("safetyTabIndex",t),this.pageSize=10,this.keyword="",this.getData()},checkSubTab(t){this.subTabIndex!==t+1&&(this.subTabIndex=t+1,localStorage.setItem("safetySubIndex",t+1),this.pageSize=10,this.keyword="",this.getData())},loadMore(){this.pageSize+=10,this.getData()},toDetail(t){this.$router.push("/safety/safetycheckself/detail?id="+t)},add(){this.$router.push("/safety/safetycheckself/add")}}},r=o,c=(a("9086"),a("2877")),d=Object(c["a"])(r,s,i,!1,null,"26c06ec6",null);e["default"]=d.exports},9086:function(t,e,a){"use strict";a("e1bc")},e1bc:function(t,e,a){}}]);